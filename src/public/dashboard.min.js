(()=>{var a,t=JSON.parse(document.currentScript.getAttribute("data-params")),d='<div class="dashboard-widget-tools d-flex justify-content-center"><i class="fa-solid fa-trash-can" data-action="line-remove"></i></div>',e='<div class="d-line-break line-edit">'+d+"</div>",o='<div id="placeholder" class="d-none"></div',i=function(){var d=[];$("[data-widget-name]").each((function(a,t){return d.push($(t).data("widget-name"))})),$.ajax({url:t.modal_route,type:"post",data:{widgets:d},success:function(t){a=bootbox.dialog({message:t,size:"large",onHide:function(){$("#placeholder").remove()}})}})},s=function(){$("#toggle-dashboard").data("status","unlocked").removeClass("btn-outline-secondary").addClass("btn-danger").html('<i class="fa-solid fa-lock-open fa-fw"></i>'),$("#dashboard-widgets").append('<div class="dashboard-buttons d-flex flex-column justify-content-between"><button class="btn btn-outline-secondary btn-sm mb-2" data-action="select-widget"><i class="fa-solid fa-plus fa-fw"></i></button><button class="btn btn-outline-secondary btn-sm" data-action="dashboard-add-line"><i class="fa-solid fa-fw fa-rotate-180 fa-share"></i></i></button></div>'),$(".d-line-break").addClass("line-edit").html(d),$(".dashboard-widget").prepend('<div class="dashboard-widget-tools d-flex flex-column justify-content-between"><div class="d-flex justify-content-between"><i class="fa fa-solid fa-square-plus" data-action="add-before"></i><i class="fa fa-solid fa-square-plus" data-action="add-after"></i></div><div class="d-flex justify-content-center"><i class="fa-solid fa-trash-can" data-action="remove"></i></div><div class="d-flex justify-content-between align-items-center"><span><i class="fa-solid fa-square-caret-left" data-action="move-left"></i>&nbsp;<i class="fa-solid fa-square-caret-right" data-action="move-right"></i></span><span><i class="fa-solid fa-share fa-rotate-180" data-action="new-line"></i></span></div></div>'),$(".d-line-break").prev(".dashboard-widget").find('[data-action="new-line"]').remove(),$(".dashboard-buttons").prev(".dashboard-widget").find('[data-action="new-line"],[data-action="move-right"],[data-action="add-after"]').remove(),0===$(".dashboard-widget").length&&$('[data-action="dashboard-add-line"]').addClass("d-none"),$(".dashboard-buttons").prev().hasClass("d-line-break")&&$('.dashboard-buttons [data-action="dashboard-add-line"]').remove(),$("#dashboard-widgets .dashboard-widget:first-child").find('[data-action="move-left"]').remove(),$("#dashboard-widgets .dashboard-widget:first-child").next().hasClass("d-line-break")&&$("#dashboard-widgets .dashboard-widget:first-child").find('[data-action="move-right"]').remove(),$("#dashboard-widgets div:first-child").hasClass("d-line-break")&&$("#dashboard-widgets div:first-child").remove()},n=function(){$("#toggle-dashboard").data("status","locked").removeClass("btn-danger").addClass("btn-outline-secondary").html('<i class="fa-solid fa-lock fa-fw"></i>'),$(".dashboard-widget-tools").remove(),$(".d-line-break").removeClass("line-edit"),$(".dashboard-buttons").remove()},c=function(){var a;n(),s(),a=[],$("#dashboard-widgets > div.dashboard-widget, #dashboard-widgets > div.d-line-break").each((function(t,d){void 0!==$(d).data("widget-name")?a.push($(d).data("widget-name")):a.push("line-break")})),$.ajax({url:t.save_widgets,type:"post",data:{widgets:JSON.stringify(a)}})};$("#toggle-dashboard").on("click",(function(){"locked"===$(this).data("status")?s():n()})),$((function(){"unlocked"===$("#toggle-dashboard").data("status")&&s()})),$(document).on("click",'[data-action="select-widget"]',(function(){$(".dashboard-buttons").before(o),i()})),$(document).on("click",'[data-action="add-after"]',(function(){$(this).closest(".dashboard-widget").after(o),i()})),$(document).on("click",'[data-action="add-before"]',(function(){$(this).closest(".dashboard-widget").before(o),i()})),$(document).on("click",'.dashboard-widget-tools [data-action="move-right"]',(function(){var a=$(this).closest(".dashboard-widget");a.next().after(a),c()})),$(document).on("click",'.dashboard-widget-tools [data-action="move-left"]',(function(){var a=$(this).closest(".dashboard-widget");a.prev().before(a),c()})),$(document).on("click",'[data-action="add-widget"]',(function(){$.ajax({url:t.load_widget,type:"post",data:{slug:$(this).attr("data-slug")},success:function(t){$("#placeholder").replaceWith(t),c(),a.modal("hide")}})})),$(document).on("click",'.dashboard-widget-tools [data-action="remove"]',(function(){$(this).closest(".dashboard-widget").remove(),c()})),$(document).on("click","[data-action=remove-widget]",(function(){$('[data-widget-name="'+$(this).data("slug")+'"]').remove(),c(),a.modal("hide")})),$(document).on("click",'.dashboard-widget-tools [data-action="new-line"]',(function(){$(this).closest(".dashboard-widget").after(e),c()})),$(document).on("click",'[data-action="dashboard-add-line"]',(function(){$(".dashboard-buttons").before(e),c()})),$(document).on("click",'[data-action="line-remove"]',(function(){$(this).closest(".d-line-break").remove(),c()}))})();