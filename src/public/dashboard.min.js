(()=>{function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(t)}function t(t,e,d){return(e=function(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var d=t[Symbol.toPrimitive];if(void 0!==d){var o=d.call(t,e||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:d,enumerable:!0,configurable:!0,writable:!0}):t[e]=d,t}var e,d=JSON.parse(document.currentScript.getAttribute("data-params")),o='<div class="dashboard-widget-tools d-flex justify-content-center"><i class="fa-solid fa-trash-can" data-action="line-remove"></i></div>',i='<div class="d-line-break line-edit">'+o+"</div>",s='<div id="placeholder" class="d-none"></div',n=function(){var a=[];$("[data-widget-name]").each((function(t,e){return a.push($(e).data("widget-name"))})),$.ajax({url:d.modal_route,type:"post",data:{widgets:a},success:function(a){e=bootbox.dialog({message:a,size:"large",onHide:function(){$("#placeholder").remove()}})}})},r=function(){$("#toggle-dashboard").data("status","unlocked").removeClass("btn-outline-secondary").addClass("btn-danger").html('<i class="fa-solid fa-lock-open fa-fw"></i>'),$("#dashboard-widgets").append('<div class="dashboard-buttons d-flex flex-column justify-content-between"><button class="btn btn-outline-secondary btn-sm mb-2" data-action="select-widget"><i class="fa-solid fa-plus fa-fw"></i></button><button class="btn btn-outline-secondary btn-sm" data-action="dashboard-add-line"><i class="fa-solid fa-fw fa-rotate-180 fa-share"></i></i></button></div>'),$(".d-line-break").addClass("line-edit").html(o),$(".dashboard-widget").prepend('<div class="dashboard-widget-tools d-flex flex-column justify-content-between"><div class="d-flex justify-content-between"><i class="fa fa-solid fa-square-plus" data-action="add-before"></i><i class="fa fa-solid fa-square-plus" data-action="add-after"></i></div><div class="d-flex justify-content-center"><i class="fa-solid fa-trash-can" data-action="remove"></i></div><div class="d-flex justify-content-between align-items-center"><span><i class="fa-solid fa-square-caret-left" data-action="move-left"></i>&nbsp;<i class="fa-solid fa-square-caret-right" data-action="move-right"></i></span><span><i class="fa-solid fa-share fa-rotate-180" data-action="new-line"></i></span></div></div>'),$(".d-line-break").prev(".dashboard-widget").find('[data-action="new-line"]').remove(),$(".dashboard-buttons").prev(".dashboard-widget").find('[data-action="new-line"],[data-action="move-right"],[data-action="add-after"]').remove(),0===$(".dashboard-widget").length&&$('[data-action="dashboard-add-line"]').addClass("d-none"),$(".dashboard-buttons").prev().hasClass("d-line-break")&&$('.dashboard-buttons [data-action="dashboard-add-line"]').remove(),$("#dashboard-widgets .dashboard-widget:first-child").find('[data-action="move-left"]').remove(),$("#dashboard-widgets .dashboard-widget:first-child").next().hasClass("d-line-break")&&$("#dashboard-widgets .dashboard-widget:first-child").find('[data-action="move-right"]').remove(),$("#dashboard-widgets div:first-child").hasClass("d-line-break")&&$("#dashboard-widgets div:first-child").remove()},c=function(){$("#toggle-dashboard").data("status","locked").removeClass("btn-danger").addClass("btn-outline-secondary").html('<i class="fa-solid fa-lock fa-fw"></i>'),$(".dashboard-widget-tools").remove(),$(".d-line-break").removeClass("line-edit"),$(".dashboard-buttons").remove()},l=function(){var a;c(),r(),a=[],$("#dashboard-widgets > div.dashboard-widget, #dashboard-widgets > div.d-line-break").each((function(e,d){var o=$(d).data("widget-name");if(void 0!==o){var i=$(d).data("widget-parameters"),s=t({},o,i?JSON.parse(i):{});a.push(s)}else a.push({"line-break":{}})})),$.ajax({url:d.save_widgets,type:"post",data:{widgets:JSON.stringify(a)}})};$("#toggle-dashboard").on("click",(function(){"locked"===$(this).data("status")?r():c()})),$((function(){"unlocked"===$("#toggle-dashboard").data("status")&&r()})),$(document).on("click",'[data-action="select-widget"]',(function(){$(".dashboard-buttons").before(s),n()})),$(document).on("click",'[data-action="add-after"]',(function(){$(this).closest(".dashboard-widget").after(s),n()})),$(document).on("click",'[data-action="add-before"]',(function(){$(this).closest(".dashboard-widget").before(s),n()})),$(document).on("click",'.dashboard-widget-tools [data-action="move-right"]',(function(){var a=$(this).closest(".dashboard-widget");a.next().after(a),l()})),$(document).on("click",'.dashboard-widget-tools [data-action="move-left"]',(function(){var a=$(this).closest(".dashboard-widget");a.prev().before(a),l()})),$(document).on("click",'[data-action="add-widget"]',(function(){$.ajax({url:d.load_widget,type:"post",data:{slug:$(this).attr("data-slug")},success:function(a){$("#placeholder").replaceWith(a),l(),e.modal("hide")}})})),$(document).on("click",'.dashboard-widget-tools [data-action="remove"]',(function(){$(this).closest(".dashboard-widget").remove(),l()})),$(document).on("click","[data-action=remove-widget]",(function(){$('[data-widget-name="'+$(this).data("slug")+'"]').remove(),l(),e.modal("hide")})),$(document).on("click",'.dashboard-widget-tools [data-action="new-line"]',(function(){$(this).closest(".dashboard-widget").after(i),l()})),$(document).on("click",'[data-action="dashboard-add-line"]',(function(){$(".dashboard-buttons").before(i),l()})),$(document).on("click",'[data-action="line-remove"]',(function(){$(this).closest(".d-line-break").remove(),l()}))})();